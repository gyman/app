parameters:
    voucher_entity.class: Gyman\Bundle\VouchersBundle\Entity\Voucher
    voucher_repository.class: Gyman\Bundle\VouchersBundle\Entity\VoucherRepository
    date_validator.class: Gyman\Bundle\VouchersBundle\Validator\VoucherDateValidator
services:
    gyman.twig.voucher_extension:
        class: Gyman\Bundle\VouchersBundle\Twig\VoucherExtension
        calls:
          - [setTranslator, [@translator]]
        tags:
            - { name: twig.extension }

    gyman.vouchers.repository.entry:
      class:          Gyman\Bundle\VouchersBundle\Repository\EntryRepository
      factory_service: doctrine.orm.club_entity_manager
      factory_method:  getRepository
      arguments:
        - Gyman\Bundle\VouchersBundle\Entity\Entry

    voucher_repository:
        class:          "%voucher_repository.class%"
        factory_service: doctrine
        factory_method:  getRepository
        arguments: [ "%voucher_entity.class%" ]

    voucher_manager:
        class:          Gyman\Bundle\VouchersBundle\Services\Manager\VoucherManager
        parent:         gyman.base.entity_manager
        calls:
             - [ setClass, [%voucher_entity.class%] ]
             - [ setEntityManager, [@doctrine.orm.club_entity_manager]]

    validator.voucher_date:
        class:          "%date_validator.class%"
        arguments:
            - "@voucher_manager"
        tags:
            - { name: validator.constraint_validator, alias: validator.voucher_date_constraint}