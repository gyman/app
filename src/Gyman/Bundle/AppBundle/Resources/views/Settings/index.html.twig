{% extends '::base.html.twig' %}

{% block stylesheets %}
    {{ parent() }}
<style>
    div#club_settings_sections > div.control-group > label.control-label {
        display: none;
    }
</style>
{% endblock stylesheets %}

{% block javascripts %}
    {{ parent() }}

    <script>
        var $form = $("form[name='club_settings']");
        var collectionHolderSelector = 'div#club_settings_sections';

        var removeEventName = 'click.removeSection';
        var removeButtonClass = 'a.remove-collection-entry';
        var removeButtonHandler = function(e) {
            if(confirm('{{ 'remove_collection_element_confirmation'|trans }}')) {
                $("#" + $(e.target).data('entry-id')).remove();
            }
        };

        var addEventName = 'click.addSection';
        var addButtonId = '#club_settings_add_section';
        var addHandler = function(e) {
            $collectionHolder = $(collectionHolderSelector);
            var prototype = $collectionHolder.data('prototype');
            var index = $collectionHolder.data('index');
            var newForm = prototype.replace(/__name__label__/g, index);
            newForm = newForm.replace(/__name__/g, index);
            $collectionHolder.data('index', index + 1);
            $collectionHolder.append(newForm);
        };

        jQuery(document).ready(function() {
            $collectionHolder = $(collectionHolderSelector);
            $collectionHolder.data('index', $collectionHolder.find(':input:text').length);

            $form.on(addEventName, addButtonId, addHandler);
            $collectionHolder.on(removeEventName, removeButtonClass, removeButtonHandler);
        });
    </script>
{% endblock javascripts %}

{% block content %}
    <div class="heading">
        <h3>{{ 'settings.header.title' }}</h3>
    </div>

    <div class="row-fluid">
        <div class="span12">
            {% include "::_flash.html.twig" %}
        </div>
    </div>

    {{ form_start(form) }}
    <div class="row-fluid">
        <div class="span6">
            {{ form_row(form.subdomain) }}
            {{ form_row(form.details.upload_logo) }}
            <fieldset>
                <legend>Sections</legend>
                {{ form_row(form.sections) }}
                {{ form_row(form.add_section) }}
            </fieldset>
        </div>
        <div class="span6">
            <fieldset>
                <legend>Contact details</legend>
                <div class="row-fluid">
                    <div class="span6">
                        {{ form_row(form.details.address) }}
                        {{ form_row(form.details.zipcode) }}
                        {{ form_row(form.details.city) }}
                        {{ form_row(form.details.country) }}
                        {{ form_row(form.details.phone_number) }}
                        {{ form_row(form.details.email_address) }}
                    </div>
                    <div class="span6">
                        {{ form_row(form.details.opened_from) }}
                        {{ form_row(form.details.opened_till) }}
                        {{ form_row(form.details.about) }}
                        {{ form_row(form.details.account_number) }}
                    </div>
                </div>
            </fieldset>
        </div>
    </div>

    <div class="row-fluid">
        <div class="span12">
            <div class="form-actions">
                {{ form_widget(form.submit, {attr: {class: 'btn btn-primary'}}) }}
            </div>
        </div>
    </div>

    {{ form_end(form) }}
{% endblock content %}