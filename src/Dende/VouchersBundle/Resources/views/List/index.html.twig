{% extends "base.html.twig" %}

{% block body_class %}vouchersList{% endblock %}

{% block body %}
<div class="heading">
    <h3>Karnety</h3>                    
    <a href="{{path("_member_new")}}" class="btn pull-right createNewVoucher"><span class="icon32 icomoon-icon-new green"></span>Nowy karnet</a>
</div><!-- End .heading-->

<!-- Build page from here: Usual with <div class="row-fluid"></div> -->


<div class="row-fluid">

    <div class="span12">

        <div class="box gradient">

            <div class="title">
                <h4>
                    <span>{% block vouchersTitle %}Lista karnetów{% endblock vouchersTitle %}</span>
                </h4>
            </div>

            <div class="content noPad clearfix">
                {% block vouchersBody %}
                <table cellpadding="0" cellspacing="0" border="0" class="dynamicTable display table table-bordered" width="100%" id="vouchersList">
                    <thead>
                        <tr>
                            <th>Właściciel</th>
                            <th>Okres ważności</th>
                            <th>Wejść</th>
                            <th>Data sprzedaży</th>
                            <th>Cena</th>
                            <th>Aktywności</th>
                            <th>Akcje</th>
                        </tr>
                    </thead>
                    <tbody>
        {% for voucher in vouchers %}
                        <tr>
                            <td class="profileColumn">
                                {% include "MembersBundle:List:_member_column.html.twig" with {"member" : voucher.getMember() } %}
                            </td>
                            <td>
                                {{ voucher.getStartDate()|date("d.m.y") }} - {{ voucher.getEndDate()|date("d.m.y") }}
                            </td>
                            <td>
                                <div class="badge badge-warning">
                                {% if voucher.getAmount() is not null %}
                                {{ voucher.getAmountLeft() }}/{{ voucher.getAmount() }}
                                {% else %}
                                    open
                                {% endif %}
                                </div>
                            </td>
                            <td>
                                {{ voucher.getCreated()|date("d.m.y") }}
                                <sup>{{ voucher.getCreated()|date("H:i") }}</sup>
                            </td>
                            <td>
                                {{ voucher.getPrice() }} zł
                            </td>
                            <td>
                                {% for i,activity in voucher.getActivities() %}
                                <div class="badge badge-success">{{ activity.getName() }}</div><br />
                                {% endfor %}
                            </td>
                            <td class="actionColumn">
                                <div class="btn-group">
                                    <a class="btn btn-mini addEntrance" href="{{ path("_entrance_add", {"id" : voucher.getMember().getId() }) }}"><span class="icomoon-icon-signup "></span> Wejście</a>
                                    <a class="btn btn-mini addEntrance" href=""><span class="icomoon-icon-signup "></span> Zamknij</a>
                                </div>
                            </td>
                        </tr>
        {% endfor %}
                    </tbody>
                </table>
                {% endblock vouchersBody %}
            </div>

        </div><!-- End .box -->

    </div><!-- End .span12 -->

</div><!-- End .row-fluid -->

{% include 'MembersBundle::_memberModal.html.twig' %}
{% include 'MembersBundle::_voucherModal.html.twig' %}

{% endblock body %}

{# javascripts #}

{% block javascripts %}
    {{ parent() }}

    {% javascripts
        '@LayoutBundle/Resources/public/plugins/tables/dataTables/jquery.dataTables.js'
        '@LayoutBundle/Resources/public/plugins/forms/select2/select2.min.js'
        '@MembersBundle/Resources/public/coffee/members.list.coffee'
        '@DefaultBundle/Resources/public/js/jquery.ui.widget.js'
        '@DefaultBundle/Resources/public/js/jquery.iframe-transport.js'
        '@DefaultBundle/Resources/public/js/jquery.fileupload.js'
        '@DefaultBundle/Resources/public/js/jquery.ui.spinner.js'
     %}

<script src="{{ asset_url }}"></script>

    {% endjavascripts %}

<script>
    $(function() {
        $("table#vouchersList").dataTable();
    });
</script>
{% endblock javascripts %}

{# CSS #}

{% block stylesheets %}
    {{ parent() }}

    {% stylesheets filter='cssrewrite'
        'bundles/layout/plugins/tables/dataTables/jquery.dataTables.css'
        'bundles/layout/plugins/forms/select2/select2.css'
        'bundles/layout/plugins/forms/select2/select2-bootstrap.css'
        '@VouchersBundle/Resources/public/less/vouchers-list.less'
        filter="cssrewrite"
    %}

<link rel="stylesheet" href="{{ asset_url }}" />

    {% endstylesheets %}
{% endblock stylesheets %}